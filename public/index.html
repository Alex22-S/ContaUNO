<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ContaUNO - Contabilidad Inteligente</title>
    <link rel="stylesheet" href="CSS/style.css">
    <link rel="stylesheet" href="CSS/calendar.css">
    <link rel="stylesheet" href="CSS/form.css">
    <link rel="stylesheet" href="CSS/balance.css"> 
    <link rel="stylesheet" href="CSS/analysis.css"> 
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf-autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
</head>
<body class="dark-mode"> <div class="floating-elements" id="floatingElements"></div>
    
    <header class="header">
        <nav class="nav">
            <div class="logo">ContaUNO</div>
            <div class="nav-links">
                <a href="#" class="nav-link">Inicio</a>
                <a href="#" class="nav-link">Caracter√≠sticas</a>
                <a href="#" class="nav-link">Precios</a>
                <a href="#" class="nav-link">Soporte</a>
                <div class="theme-switcher">
                    <input type="checkbox" id="theme-toggle">
                    <label for="theme-toggle">
                        <span class="sun">‚òÄÔ∏è</span>
                        <span class="moon">üåô</span>
                    </label>
                </div>
            </div>
        </nav>
    </header>

    <main class="hero" id="hero">
        <h1 class="hero-title">ContaUNO</h1>
        <p class="hero-subtitle">Selecciona el modo que mejor se adapte a tus necesidades empresariales</p>
        
        <div class="level-selector">
            <div class="level-card basic" onclick="showDashboard('basic')">
                <div class="level-icon">üå±</div>
                <h3 class="level-title">Contabilidad B√°sica</h3>
                <p class="level-description">Perfecto para emprendedores y peque√±os negocios. Funciones simples y guiadas paso a paso.</p>
            </div>
            
            <div class="level-card intermediate" onclick="showDashboard('intermediate')">
                <div class="level-icon">üìä</div>
                <h3 class="level-title">Contabilidad Media</h3>
                <p class="level-description">Para empresas en crecimiento. Herramientas intermedias con an√°lisis detallados.</p>
            </div>
            
            <div class="level-card advanced" onclick="showDashboard('advanced')">
                <div class="level-icon">üöÄ</div>
                <h3 class="level-title">Contabilidad Avanzada</h3>
                <p class="level-description">Para contadores profesionales. Funciones complejas y an√°lisis profundos.</p>
            </div>
        </div>
    </main>

    <div class="calendar-view" id="calendar-view">
        <button class="back-btn" onclick="showDashboard('basic')">‚Üê Volver al Dashboard</button>
        <div class="calendar-container">
            <div class="calendar-header">
                <h2 class="calendar-main-title">Registro de Transacciones</h2>
                <div class="calendar-controls">
                    <select id="month-select" onchange="updateCalendar()">
                        <option value="0">Enero</option>
                        <option value="1">Febrero</option>
                        <option value="2">Marzo</option>
                        <option value="3">Abril</option>
                        <option value="4">Mayo</option>
                        <option value="5">Junio</option>
                        <option value="6">Julio</option>
                        <option value="7">Agosto</option>
                        <option value="8">Septiembre</option>
                        <option value="9">Octubre</option>
                        <option value="10">Noviembre</option>
                        <option value="11">Diciembre</option>
                    </select>
                    <select id="year-select" onchange="updateCalendar()"></select>
                </div>
            </div>
            
            <div class="calendar-content">
                <div class="calendar-grid-container">
                    <div class="calendar-grid" id="calendar-grid">
                        <div class="calendar-day-header">Lun</div>
                        <div class="calendar-day-header">Mar</div>
                        <div class="calendar-day-header">Mi√©</div>
                        <div class="calendar-day-header">Jue</div>
                        <div class="calendar-day-header">Vie</div>
                        <div class="calendar-day-header">S√°b</div>
                        <div class="calendar-day-header">Dom</div>
                    </div>
                </div>

                <div class="calendar-summary">
                    <h3 class="summary-title">Resumen del Mes</h3>
                    <div class="summary-card income">
                        <div class="summary-info">
                            <span class="summary-label">Ingresos</span>
                            <span class="summary-value" id="monthly-income">$0</span>
                        </div>
                    </div>
                    <div class="summary-card expense">
                        <div class="summary-info">
                            <span class="summary-label">Gastos</span>
                            <span class="summary-value" id="monthly-expenses">$0</span>
                        </div>
                    </div>
                    <div class="summary-card balance">
                         <div class="summary-info">
                            <span class="summary-label">Balance</span>
                            <span class="summary-value" id="monthly-balance">$0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="form-view" id="form-view">
        <div class="form-page-layout">
            <div class="form-wrapper">
                <div class="form-header-full">
                    <h2 id="form-title">Registrar Movimiento</h2>
                    <button class="back-btn-form" onclick="showCalendar()">‚Üê Volver al Calendario</button>
                </div>
                <form id="transaction-form-full">
                    <input type="hidden" id="editing-transaction-id">

                    <div class="form-group template-group">
                        <label for="template-select">Aplicar Plantilla</label>
                        <div class="template-manager">
                            <select id="template-select">
                                <option value="">-- Selecciona una plantilla --</option>
                            </select>
                            <button type="button" id="edit-template-btn" title="Renombrar Plantilla Seleccionada">‚úèÔ∏è</button>
                            <button type="button" id="delete-template-btn" title="Eliminar Plantilla Seleccionada">üóëÔ∏è</button>
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-column">
                            <div class="form-group">
                                <label for="form-date-display">Fecha</label>
                                <input type="text" id="form-date-display" readonly>
                            </div>
                            <div class="form-group">
                                <label for="form-type">Tipo de Movimiento</label>
                                <select id="form-type" required>
                                    <option value="income">üí∞ Ingreso</option>
                                    <option value="expense">üí∏ Gasto</option>
                                </select>
                            </div>
                            <div class="form-group category-group">
                                <label for="form-category">Categor√≠a</label>
                                <div class="category-manager">
                                    <select id="form-category" required></select>
                                    <button type="button" id="add-category-btn" title="A√±adir Categor√≠a">‚ûï</button>
                                    <button type="button" id="edit-category-btn" title="Editar Categor√≠a Seleccionada">‚úèÔ∏è</button>
                                    <button type="button" id="delete-category-btn" title="Eliminar Categor√≠a Seleccionada">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="form-amount">Monto</label>
                                <input type="number" id="form-amount" step="0.01" min="0" required placeholder="1.250.000,00">
                            </div>
                        </div>
                        <div class="form-column">
                            <div class="form-group">
                                <label for="form-description">Descripci√≥n Corta</label>
                                <input type="text" id="form-description" required placeholder="Ej: Venta de mercanc√≠a, pago de arriendo...">
                            </div>
                            <div class="form-group">
                                <label for="form-provider">Proveedor / Cliente (Opcional)</label>
                                <input type="text" id="form-provider" placeholder="Nombre del tercero">
                            </div>
                            <div class="form-group">
                                <label for="form-provider-id">NIT / C.C. (Opcional)</label>
                                <input type="text" id="form-provider-id" placeholder="N√∫mero de identificaci√≥n">
                            </div>
                            <div class="form-group">
                                <label for="form-notes">Notas / Observaciones (Opcional)</label>
                                <textarea id="form-notes" rows="2" placeholder="Detalles adicionales del movimiento..."></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions-full">
                        <button type="submit" class="save-btn" id="save-transaction-btn">üíæ Guardar Transacci√≥n</button>
                        <button type="button" class="template-btn" id="save-template-btn">‚≠ê Guardar Plantilla</button>
                        <button type="button" class="cancel-btn" onclick="clearFormAndReturn()">‚ùå Cancelar / Volver</button>
                    </div>
                </form>
            </div>

            <div class="daily-summary-panel">
                <div class="daily-summary-header">
                    <h3>Movimientos del D√≠a</h3>
                    <button id="download-pdf-btn" class="pdf-btn" title="Descargar Resumen en PDF">üìÑ PDF</button>
                </div>
                <div class="daily-transactions-list" id="daily-transactions-list">
                    <p class="no-transactions-msg">No hay movimientos registrados para este d√≠a.</p>
                </div>
                <div class="daily-summary-footer">
                    <div class="footer-item">
                        <span>Ingresos:</span>
                        <span id="daily-income" class="positive-value">$0</span>
                    </div>
                    <div class="footer-item">
                        <span>Gastos:</span>
                        <span id="daily-expenses" class="negative-value">$0</span>
                    </div>
                     <div class="footer-item total">
                        <span>Balance del D√≠a:</span>
                        <span id="daily-balance">$0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="balance-view" id="balance-view">
        <button class="back-btn" onclick="showDashboard('basic')">‚Üê Volver al Dashboard</button>

        <div class="balance-container">
            <div class="balance-header">
                <h2 class="balance-main-title">Balance Simple</h2>
                <div class="balance-controls">
                    <select id="balance-month-select" onchange="updateBalanceView()"></select>
                    <select id="balance-year-select" onchange="updateBalanceView()"></select>
                </div>
            </div>

            <div class="balance-view-toggle">
                <button id="btn-weekly-view" class="active" onclick="switchBalanceView('weekly')">üóìÔ∏è Semanal</button>
                <button id="btn-monthly-view" disabled>üìä Mensual</button>
                <button id="btn-annual-view" disabled>üöÄ Anual</button>
            </div>

            <div id="weekly-content" class="balance-content-view">
                <div class="monthly-summary-panel">
                    <div class="monthly-summary-header">
                        <h3 class="monthly-summary-title">Resumen Total del Mes</h3>
                        <button id="download-month-summary-pdf" class="pdf-btn-main" title="Descargar Resumen Mensual en PDF">
                            <span class="icon">üìÑ</span>
                            Descargar PDF del Mes
                        </button>
                    </div>
                    <div class="monthly-summary-cards">
                        <div class="summary-card-balance income">
                            <span class="summary-label">Ingresos del Mes</span>
                            <span class="summary-value" id="total-month-income">$0</span>
                        </div>
                        <div class="summary-card-balance expense">
                            <span class="summary-label">Gastos del Mes</span>
                            <span class="summary-value" id="total-month-expenses">$0</span>
                        </div>
                        <div class="summary-card-balance balance">
                            <span class="summary-label">Balance Mensual</span>
                            <span class="summary-value" id="total-month-balance">$0</span>
                        </div>
                    </div>
                </div>
                
                <div class="weekly-breakdown" id="weekly-breakdown-container">
                </div>

                <div class="charts-section">
                    <div class="chart-container">
                        <h3 class="chart-title">Ingresos vs. Gastos (Dona)</h3>
                        <div class="canvas-wrapper">
                            <canvas id="monthly-summary-chart"></canvas>
                        </div>
                        </div>
                    <div class="chart-container">
                        <h3 class="chart-title">Balance Semanal (Barras)</h3>
                        <div class="canvas-wrapper">
                            <canvas id="weekly-bar-chart"></canvas>
                        </div>
                        </div>
                </div>

                <div class="full-report-section">
                    <button id="btn-generate-full-report" class="btn-main-action">
                        <span class="icon">üìà</span>
                        Generar Resumen Financiero Completo
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="dashboard" id="basic-dashboard">
        <button class="back-btn" onclick="showHero()">‚Üê Volver</button>
        <div class="dashboard-header">
            <h2 class="dashboard-title">Contabilidad B√°sica</h2>
            <p>Herramientas simples para empezar tu negocio</p>
        </div>
        
        <div class="search-container">
            <input type="text" class="search-input" placeholder="Buscar funci√≥n..." onkeyup="filterFunctions(this.value, 'basic')">
        </div>
        
        <div class="functions-grid" id="basic-functions">
            <div class="function-card" onclick="showCalendar()">
                <h4 class="function-title">Registro de Ingresos y Gastos</h4>
                <p class="function-description">Registra y controla todas tus entradas y salidas de dinero en un solo lugar.</p>
            </div>
            <div class="function-card" onclick="showBalanceView()">
                <h4 class="function-title">Balance Simple</h4>
                <p class="function-description">Ve cu√°nto tienes vs cu√°nto debes de forma clara.</p>
            </div>
            <div class="function-card">
                <h4 class="function-title">Facturas B√°sicas</h4>
                <p class="function-description">Crea facturas profesionales en minutos.</p>
            </div>
            <div class="function-card">
                <h4 class="function-title">Control de Inventario</h4>
                <p class="function-description">Gestiona tu stock de productos b√°sicos.</p>
            </div>
            <div class="function-card">
                <h4 class="function-title">Registro de ahorros</h4>
                <p class="function-description">Registra tus ahorros y metas.</p>
            </div>
            <div class="function-card">
                <h4 class="function-title">Flujo de Caja</h4>
                <p class="function-description">Visualiza el dinero que entra y sale.</p>
            </div>
            <div class="function-card">
                <h4 class="function-title">Recordatorios</h4>
                <p class="function-description">No olvides fechas importantes de pagos.</p>
            </div>
            <div class="function-card">
                <h4 class="function-title">Backup Autom√°tico</h4>
                <p class="function-description">Tus datos siempre seguros en la nube.</p>
            </div>
        </div>
    </div>

    <div class="dashboard" id="intermediate-dashboard">
        <button class="back-btn" onclick="showHero()">‚Üê Volver</button>
    </div>

    <div class="dashboard" id="advanced-dashboard">
        <button class="back-btn" onclick="showHero()">‚Üê Volver</button>
    </div>

    <div class="analysis-report-view" id="full-analysis-view">
        <button class="back-btn" onclick="showBalanceView()">‚Üê Volver al Balance</button>
        <div class="analysis-container">
            <div class="analysis-header">
                <h2>Reporte Financiero Detallado</h2>
                <p id="analysis-period">Mes y A√±o</p>
            </div>

            <div class="kpi-grid">
                <div class="kpi-card income">
                    <h4>Ingresos Totales</h4>
                    <p id="kpi-total-income">$0</p>
                </div>
                <div class="kpi-card expense">
                    <h4>Gastos Totales</h4>
                    <p id="kpi-total-expense">$0</p>
                </div>
                <div class="kpi-card balance">
                    <h4>Balance Neto</h4>
                    <p id="kpi-net-balance">$0</p>
                </div>
                <div class="kpi-card special">
                    <h4>D√≠a M√°s Rentable</h4>
                    <p id="kpi-best-day">N/A</p>
                </div>
            </div>

            <div class="analysis-charts-grid">
                <div class="analysis-chart-container">
                    <h3 class="analysis-card-title">Flujo de Dinero Diario</h3>
                    <div class="canvas-wrapper-analysis">
                        <canvas id="daily-flow-chart"></canvas>
                    </div>
                </div>
                <div class="analysis-chart-container">
                    <h3 class="analysis-card-title">Distribuci√≥n de Ingresos</h3>
                     <div class="canvas-wrapper-analysis">
                        <canvas id="income-distribution-chart"></canvas>
                    </div>
                </div>
                <div class="analysis-chart-container">
                    <h3 class="analysis-card-title">Distribuci√≥n de Gastos</h3>
                     <div class="canvas-wrapper-analysis">
                        <canvas id="expense-distribution-chart"></canvas>
                    </div>
                </div>
            </div>

            <div class="category-tables-grid">
                <div class="category-table-container">
                    <h3 class="analysis-card-title">Ingresos por Categor√≠a</h3>
                    <div class="table-wrapper">
                        <table id="category-income-table">
                            <thead>
                                <tr>
                                    <th>Categor√≠a</th>
                                    <th>Monto Total</th>
                                    <th>Porcentaje del Total</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="category-table-container">
                    <h3 class="analysis-card-title">Gastos por Categor√≠a</h3>
                    <div class="table-wrapper">
                        <table id="category-expense-table">
                            <thead>
                                <tr>
                                    <th>Categor√≠a</th>
                                    <th>Monto Total</th>
                                    <th>Porcentaje del Total</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="strategic-insights-panel">
                <div class="insight-column">
                    <h3 class="insight-column-title">
                        <span class="icon">‚úÖ</span> Puntos Positivos
                    </h3>
                    <div id="positive-insights-content">
                        </div>
                </div>
                <div class="insight-column">
                    <h3 class="insight-column-title">
                        <span class="icon">‚ö†Ô∏è</span> √Åreas de Atenci√≥n
                    </h3>
                    <div id="attention-insights-content">
                        </div>
                </div>
                <div class="insight-column">
                    <h3 class="insight-column-title">
                        <span class="icon">üí°</span> Sugerencias y Oportunidades
                    </h3>
                    <div id="recommendation-insights-content">
                        </div>
                </div>
            </div>
            </div>
    </div>
    
    <script src="JS/scripts.js"></script>
    <script src="JS/calendar.js"></script>
    <script src="JS/form.js"></script>
    <script src="JS/balance.js"></script>
    <script src="JS/analysis.js"></script>
</body>
</html>